# YORI Performance Benchmarks

Performance test results and benchmarks for YORI LLM governance gateway.

## Test Environment

- **OS**: Linux (Ubuntu/FreeBSD)
- **Python**: 3.11+
- **Rust**: stable
- **Hardware**: (To be filled in during actual benchmarking)

## Performance Targets

From PROJECT_PLAN.md:

| Metric | Target | Status |
|--------|--------|--------|
| Proxy Latency (p95) | <10ms | ⏳ Pending |
| Throughput | 50 req/sec | ⏳ Pending |
| Memory Usage (RSS) | <256MB | ⏳ Pending |
| SQLite Query | <100ms (100k records) | ⏳ Pending |
| Policy Evaluation | <5ms | ⏳ Pending |

## Latency Benchmarks

### Health Endpoint
```
Mean:  X.XXms
P50:   X.XXms
P95:   X.XXms
P99:   X.XXms
Max:   X.XXms
```

### Proxy Requests
```
Mean:  X.XXms
P50:   X.XXms
P95:   X.XXms
P99:   X.XXms
```

### Policy Evaluation
```
Mean:  X.XXms
P50:   X.XXms
P95:   X.XXms
P99:   X.XXms
```

## Throughput Benchmarks

### Synchronous
- Requests/sec: XXX
- Duration: XX.XXs
- Total requests: XXXX

### Asynchronous
- Requests/sec: XXX
- Duration: XX.XXs
- Concurrent requests: XXXX

### Sustained Load (60 seconds)
- Target: 50 req/sec
- Actual: XX.X req/sec
- Total requests: XXXX
- Success rate: XX.X%
- Errors: X

## Memory Benchmarks

### Idle
- RSS: XXX MB
- VMS: XXX MB

### Under Load (50 req/sec)
- RSS: XXX MB
- VMS: XXX MB
- Peak: XXX MB

### After 1 Hour
- RSS: XXX MB
- Memory leak: None detected

## Database Performance

### SQLite Audit Log

| Records | Query Type | Time (ms) | Status |
|---------|-----------|-----------|--------|
| 1,000 | SELECT | X.X | ✅ |
| 10,000 | SELECT | XX.X | ✅ |
| 100,000 | SELECT | XX.X | ✅ |
| 1,000,000 | SELECT | XXX.X | ⏳ |

### Write Performance
- Inserts/sec: XXX
- Batch insert (100): XX.Xms
- Transaction overhead: X.Xms

## Cache Performance

### Get Operations
- P50: X.XXms
- P95: X.XXms
- P99: X.XXms

### Set Operations
- P50: X.XXms
- P95: X.XXms
- P99: X.XXms

### Hit Rate
- After 1000 requests: XX.X%
- After 10000 requests: XX.X%

## Comparison with Targets

| Metric | Target | Actual | Status |
|--------|--------|--------|--------|
| Latency (p95) | <10ms | X.Xms | ⏳ |
| Throughput | 50 rps | XX.X rps | ⏳ |
| Memory | <256MB | XXX MB | ⏳ |
| SQLite | <100ms | XX.Xms | ⏳ |
| Policy | <5ms | X.Xms | ⏳ |

## Notes

- Tests run with stub implementations
- Real performance may vary once full implementation is complete
- SARK integration expected to improve policy evaluation performance
- Rust proxy implementation expected to improve latency

## Next Steps

1. Complete proxy implementation
2. Integrate SARK components
3. Re-run benchmarks with real workload
4. Optimize hot paths identified by profiling
5. Test on target hardware (OPNsense router)

## How to Run Benchmarks

```bash
# Run all performance tests
pytest tests/performance/ -v

# Run specific benchmark
pytest tests/performance/test_latency.py -v

# Run with detailed output
pytest tests/performance/ -v -s

# Generate this report
pytest tests/performance/ --benchmark-only --benchmark-json=output.json
```

---

*Last updated: Auto-generated by test suite*
*Run tests to populate actual benchmark data*
